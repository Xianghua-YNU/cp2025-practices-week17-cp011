# 项目：常微分方程的松弛迭代法 - 实验报告

**学生姓名：** 杨程宇 **学号：** 20231050197 **完成日期：** 2025.6.18

## 1. 实验目的

学习松弛迭代法求解常微分方程边值问题，通过抛体运动实例掌握数值方法的实现。

## 2. 核心算法

### 2.1 算法思路

使用二阶中心差分近似二阶导数，将微分方程转化为差分方程，然后通过松弛迭代法求解边值问题。

### 2.2 关键代码片段

```python
# 松弛迭代核心代码
while delta > tol:
    x_new = np.copy(x)
    x_new[1:-1] = 0.5 * (h * h * g + x[2:] + x[:-2])
    delta = np.max(np.abs(x_new - x))
    x = x_new
```

## 3. 实验结果
![image](https://github.com/user-attachments/assets/aff4c134-c09b-420b-8228-16f52417906d)

### 3.1 主要输出

- 最大高度：122.50 m
- 到达最大高度时间：5.00 s
- 迭代收敛次数：1240 次

### 3.2 结果验证

- 边界条件满足：x(0) = 0, x(10) = 0
- 轨迹对称性：关于 t = 5s 对称
- 物理合理性：抛体轨迹呈抛物线形状

## 4. 问题与收获

### 4.1 主要问题

1. 收敛条件的设置
在松弛迭代法中，收敛条件（delta > tol）的选取直接影响计算效率和精度
过于严格的容差（如 tol=1e-10）会导致不必要的迭代次数增加
过于宽松的容差（如 tol=1e-3）则可能牺牲解的精度
2. 迭代公式的正确实现
①数组索引处理（特别是边界点）
边界点的正确处理是迭代公式正确实现的首要前提。在数值求解中，边界条件（如抛体运动中x(0)=0和x(10)=0）必须作为固定锚点严格保持：
初始化时需显式设置边界值：x[0]=0和x[-1]=0，确保物理约束
迭代循环必须排除边界索引（仅处理range(1, n-1)的内部点）
相邻点计算需设置防越界保护（如当i=1时x[i-1]指向合法索引x[0]）
任何边界点污染都会导致解失真，例如若意外更新x[0]，将破坏整个轨迹的对称性和物理合理性。
②物理意义的正确表达（重力加速度方向）
重力方向的准确表达直接决定解的物理有效性：
微分方程d²x/dt² = -g中的负号至关重要（g>0时表示向下加速度）
迭代核心必须体现负号：0.5*(h**2 * (-g) + ...)而非0.5*(h**2 * g + ...)
物理验证三要素：
轨迹峰值在t=5s（中点时刻）、边界高度严格归零、能量守恒（动能+势能波动<1%）
方向错误将导致荒谬结果，如g取正值会使抛体向上加速飞离。
③数值稳定性（避免振荡发散）
数值稳定性控制是迭代收敛的关键保障：
变化量限幅：设置单步最大变化阈值（如|Δx|<0.1·max(x)），防止振荡发散、自适应策略：迭代后期自动放宽容差要求，避免无限循环
稳定迭代的特征是残差单调下降（max|d²x/dt² + g|持续减小），且不同步长h的解收敛于理论值122.5m、松弛因子：引入ω=1.5（超松弛）加速收敛，避免标准迭代的缓慢收敛
### 4.2 解决方法

1. 使用最大变化量作为收敛判据
2. 仔细处理数组索引，确保边界条件

### 4.3 主要收获

通过本实验掌握了松弛迭代法的基本原理，理解了边值问题与初值问题的区别，学会了用数值方法求解物理问题。

## 5. 思考题（可选）

1. 为什么松弛法适合求解边值问题而不是初值问题？
松弛法（如SOR）的核心特性决定了其更适配边值问题：
①全局耦合性：边值问题要求解在整个区间同时满足边界约束（如抛体运动中x(0)=x(10)=0），松弛法通过网格点间的全局迭代自然处理这种空间耦合。而初值问题具有时间因果性（当前状态仅依赖前一时刻），更适合龙格-库塔等逐步推进的方法。
②边界驱动机制：松弛迭代以边界条件为固定锚点（如锁定x[0]和x[-1]），通过内部点逐步松弛满足微分方程。初值问题则依赖初始条件单向传播，松弛法会破坏其时间因果链。
③稳态特性：边值问题通常描述稳态/平衡态（如热传导稳态分布），松弛法的迭代过程物理对应系统能量逐渐最小化。初值问题本质是动态演化过程，强行应用松弛法会导致物理意义错乱。
2. 如何选择合适的收敛容差和最大迭代次数
选择合适的收敛容差和最大迭代次数需兼顾计算精度与效率。收敛容差应根据问题精度需求设定：宏观分析（如抛体最高点）可选千分之一（1e-3）量级，精细计算（如应力分布）需百万分之一（1e-6）或更严；经验上取步长平方的十倍（如h=0.1时tol=0.01）可平衡离散误差，同时确保容差不低于万亿分之一（1e-12）的浮点极限。推荐采用绝对与相对容差的双重标准（如|Δx|<1e-6且|Δx|/|xₘₐₓ|<1e-4）以适配不同量级解。最大迭代次数应预防发散并关联问题规模：一维问题建议5000+10000/h次，二维则按20000+50000/h²扩展。预设值可场景化调整——快速验证取1000次迭代，工程应用取5000次，高精度研究需10000次。关键要建立智能终止机制：若迭代超100步后残差下降不足初值1%，则自动放宽容差或终止。实际操作宜先用宽松参数（tol=1e-3, max_iter=1000）试算，依据残差曲线调整：单调下降则收紧容差，震荡则优化松弛因子，本质是精度与计算成本的动态平衡。
